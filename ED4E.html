<!-- ED4 Character Sheet v1.5.1 Last update: 09-22-2017
Author: Dougansf -->
<table style="width: 730px; height: 50px; background-color: #FFFFFF;" border="5" cellpadding="3">
    <!-- Banner -->
    <tbody>
        <tr style="background-color: #f3e5d8;">
            <td style="width: 11%">
                <strong>
                     Name
                </strong>
            </td>
            <td style="width: 15%">
                <input style="width: 125px;" name="attr_Name" type="text" />
            </td>
            <td style="width: 11%">
                <strong>
                     Damage
                </strong>
            </td>
            <td style="width: 20%; text-align: center; ">
                <input name="attr_Uncon" type="number" value="0" style="width: 50px;"/>
            </td>
            <td style="width: 10%; vertical-align: middle;">
                <strong>Wounds</strong>
            </td>
            <td style="width: 10%; vertical-align: middle; text-align: center;">
                <input name="attr_Wounds" type="number" value="0" style="width: 50px;"/>
            </td>
            <td style="width: 7%; background-color: #d9d9d9;">
                 
            </td>
            <td style="width: 8%; vertical-align: bottom; text-align: center; background-color: #d9d9d9;">
                <strong>
                     DEFENSE
                </strong>
            </td>
            <td style="width: 8%; vertical-align: bottom; text-align: center; background-color: #d9d9d9;">
                <strong>
                     ARMOR
                </strong>
            </td>
        </tr>
        <tr>
            <td style="vertical-align: top; text-align: left">
                <strong>
                     Movement
                </strong> <br/>
                <select class="Metric" name="attr_Metric" style= "width: 65px;">
                    <option value="Yards">
                        Yards
                    </option>
                    <option value="Meters">
                        Meters
                    </option>
                    <option value="Hexes">
                        Hexes
                    </option>
                </select>
            </td>
            <td style= "vertical-align: top">
                <strong>
                    Base / Current
                </strong> <br/>
                <input name="attr_Movement_max" type="number" value="12"/>
                <strong>/</strong>
                <input name="attr_Movement" type="number" value="12"/>
            </td>
            <td>
                <strong>
                     Wound Threshold
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center;">
                <strong>
                    Base / Current
                </strong> <br/>
                <input name="attr_WoundThresh_max" type="number" value="7" style="width: 40px;"/>
                <strong>/</strong>
                <input name="attr_WoundThresh" type="number" value="7" style="width: 40px;"/>
            </td>
            <td>
                <strong>
                     Knockdown Threshold
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center;">
                <input disabled="disabled" name="attr_KDThresh" type="number" value="(@{WoundThresh}+5)" />
            </td>           
            <td style="vertical-align: middle; text-align: right; background-color: #d9d9d9;">
                <strong>
                     PHYSICAL
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center; background-color: #d9d9d9;">
                <input disabled="disabled" name="attr_BannerPD" type="number" value="@{PD}" />
            </td>
            <td style="vertical-align: middle; text-align: center; background-color: #d9d9d9;">
                <input disabled="disabled" name="attr_BannerPA" type="number" value="@{PA}" />
            </td>
        </tr>
        <tr style="background-color: #f3e5d8;">
            <td>
                <strong>
                     Karma
                </strong>
            </td>
            <td>
                <strong>Maximum / Current</strong> <br/> 
                <input style="background-color: #d9d9d9;" name="attr_Karma_max" type="number" value="5" style="width: 40px;"/>
                <strong>/</strong>
                <input style="background-color: #99ceff;" name="attr_Karma" type="number" value="5" style="width: 40px;"/>
                    <button name="roll_Karma" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Karma**
--Spent|[[ ?{Karma #|1} ]] Karma
--Result|** [[ [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
}}">
                    </button>
            </td>
            <td>
                <strong>
                     Unconcious Rating
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center;">
                <strong>
                    Base / Current
                </strong> <br/>
                <input name="attr_UnconBase" type="number" value="20" style="width: 40px;"/>
                <strong>/</strong>
                <input name="attr_Uncon_max" type="number" value="20" style="width: 40px;"/>
            </td>
            <td>
                <strong>
                     Resist Knockdown
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center;">
                <input name="attr_ResistKD" type="number" value="5" style="width: 40px;"/>
                <span style="background-color: #ff0000;">
                    <button name="roll_ResistKD" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Resist Knockdown**
--leftsub|vs ?{Damage Taken|@{KDThresh}} Damage
--Step|[[ ?{Step|@{ResistKD}+@{StrMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|[^Result.base]
--Successes|[[ ceil(([$Result] { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - (?{Damage Taken}-@{WoundThresh}) ) /5) ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
            </td>
            <td style="vertical-align: middle; text-align: right; background-color: #d9d9d9;">
                <strong>
                     MYSTIC
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center; background-color: #d9d9d9;">
                <input disabled="disabled" name="attr_BannerMD" type="number" value="@{MD}" />
            </td>
            <td style="vertical-align: middle; text-align: center; background-color: #d9d9d9;">
                <input disabled="disabled" name="attr_BannerMA" type="number" value="@{MA}" />
            </td>
        </tr>
        <tr>
            <td>
                <strong>
                     Initiative
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center;">
                <input disabled="disabled" name="attr_InitTotal" type="number" value="(@{DexStep}+@{DexMod}+@{InitMod}-@{ArmorMod})" />
                &nbsp; &nbsp;
                <span style="background-color: #ff0000;">
                    <strong>
                        <button name="roll_InitStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Initiative**
--Step|[[ ?{Step|@{InitTotal}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [TRKR] [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </strong>
                </span>
                <p>
                    <hidden name="attr_GroupInitiative" value="[[ [[{1e3, 8}<[[{@{InitTotal}-@{Wounds} - 11, 0}kh1 % 11]] + floor([[{@{InitTotal}-@{Wounds} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{@{InitTotal}-@{Wounds}, 0}kh1 % 11]] + {1, 3}=[[{@{InitTotal}-@{Wounds}, 0}kh1]] + {1e3, 3}=[[{@{InitTotal}-@{Wounds} - 11, 0}kh1 % 11]] * 2]]d[[{{(@{InitTotal}-@{Wounds} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{@{InitTotal}-@{Wounds}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{InitTotal}-@{Wounds}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{InitTotal}-@{Wounds}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{@{InitTotal}-@{Wounds}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{@{InitTotal}-@{Wounds}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{InitTotal}-@{Wounds}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{InitTotal}-@{Wounds}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{@{InitTotal}-@{Wounds}, 0}kh1]] * (3 - [[{@{InitTotal}-@{Wounds}, 0}kh1]])]] ]]">
                </p>
            </td>
            <td style="vertical-align: middle;">
                <strong>
                     Death Rating
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center;">
                <strong>
                    Base / Current
                </strong> <br/>
                <input name="attr_Death" type="number" value="25" style="width: 40px;"/>
                <strong>/</strong>
                <input name="attr_Death_max" type="number" value="25" style="width: 40px;"/>
            </td>
            <td style="vertical-align: middle;">
                <strong>
                    Blood Magic
                </strong>
            </td>
            <td style="vertical-align: middle; text-align: center;">
                <input name="attr_BloodMagic" type="number" value="0" style="width: 40px;"/>
            </td>
            <td style="vertical-align: middle; text-align: right; background-color: #d9d9d9;">
                <strong>
                     SOCIAL
                </strong>
            </td>
            <td style="text-align: center; background-color: #d9d9d9;">
                <input disabled="disabled" name="attr_BannerSD" type="number" value="@{SD}" />
            </td>
            <td style="background-color: #d9d9d9;">
                 
            </td>
        </tr>
    </tbody>
</table>
<p></p>
<div>
    <!-- Tab Setup -->
    <input type="radio" class="sheet-tab sheet-tab1" name="attr_core-tab" value="1" title="Attributes" checked="checked"/> 
    <span class="sheet-tab sheet-tab1" style='line-height: 20px;'>ATTRIBUTES</span>
    <input type="radio" class="sheet-tab sheet-tab2" name="attr_core-tab" value="2" title="Talents" /> 
    <span class="sheet-tab sheet-tab2" style='line-height: 20px;'>TALENTS</span>
    <input type="radio" class="sheet-tab sheet-tab3" name="attr_core-tab" value="3" title="Skills" /> 
    <span class="sheet-tab sheet-tab3" style='line-height: 20px;'>SKILLS</span>
    <input type="radio" class="sheet-tab sheet-tab4" name="attr_core-tab" value="4" title="Equipment" /> 
    <span class="sheet-tab sheet-tab4" style='line-height: 20px;'>EQUIPMENT</span>
    <input type="radio" class="sheet-tab sheet-tab5" name="attr_core-tab" value="5" title="Matrixes" /> 
    <span class="sheet-tab sheet-tab5" style='line-height: 20px;'>MATRIXES</span>
    <input type="radio" class="sheet-tab sheet-tab6" name="attr_core-tab" value="6" title="Grimoire" /> 
    <span class="sheet-tab sheet-tab6" style='line-height: 20px;'>GRIMOIRE</span>
    <input type="radio" class="sheet-tab sheet-tab7" name="attr_core-tab" value="7" title="Treasury" /> 
    <span class="sheet-tab sheet-tab7" style='line-height: 20px;'>TREASURY</span>
    <input type="radio" class="sheet-tab sheet-tab8" name="attr_core-tab" value="8" title="NPC" /> 
    <span class="sheet-tab sheet-tab8" style='line-height: 20px;'>NPC</span>
    <!-- End Tab Setup -->
<div class="sheet-section-attributes"><!-- Attributes Tab -->
<p></p>
<table style="width: 725px; height: 250px;" cellpadding="0"> <!-- Attributes & Defenses table -->
    <tbody>
        <tr>
            <td style="vertical-align: top;">
                <table style="width: 355px; height: 100%; background-color: #FFFFFF;" border="5" cellpadding="3"> <!-- Attributes Table -->
                <tbody>
                    <tr style="background-color: #f3e5d8;">
                        <td style="vertical-align: bottom; text-align: center; height:15px; width: 30%">
                            <blockquote>
                                <strong>
                                    ATTRIBUTES
                                </strong>
                            </blockquote>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 25%">
                            <blockquote>
                                <strong>
                                    VALUE
                                </strong>
                            </blockquote>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 25%" colspan="2">
                            <blockquote>
                                <strong>
                                    STEP
                                </strong>
                            </blockquote>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 20%">
                            <blockquote>
                                <strong>
                                    ROLL
                                </strong>
                            </blockquote>
                        </td>
                    </tr>
                    <tr>
                        <td style="vertical-align: bottom; text-align: left; height:15px">
                            <strong>
                                Dexterity
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <input name="attr_DexVal" type="number" value="10" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>Base</strong>
                            <input name="attr_DexStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>Modifier</strong>
                            <input name="attr_DexMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_DexStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Dexterity**
--Step|[[ ?{Step|@{DexStep}+@{DexMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td style="text-align: left;">
                            <strong>
                                Strength
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_StrVal" type="number" value="10" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_StrStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_StrMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_StrStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Strength**
--Step|[[ ?{Step|@{StrStep}+@{StrMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>
                                Toughness
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_TouVal" type="number" value="10" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_TouStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_TouMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_TouStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Toughness**
--Step|[[ ?{Step|@{TouStep}+@{TouMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td style="text-align: left;">
                            <strong>
                                Perception
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_PerVal" type="number" value="10" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_PerStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_PerMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_PerStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Perception**
--Step|[[ ?{Step|@{PerStep}+@{PerMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>
                                Willpower
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_WilVal" type="number" value="10" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_WilStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_WilMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_WilStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Willpower**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td style="text-align: left;">
                            <strong>
                                Charisma
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_ChaVal" type="number" value="10" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_ChaStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_ChaMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_ChaStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Charisma**
--Step|[[ ?{Step|@{ChaStep}+@{ChaMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>
                                Initiative
                            </strong>
                        </td>
                        <td style="text-align: center; vertical-align: bottom">
                            <strong>
                                Armor Mod
                            </strong>
                            <input name="attr_ArmorMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center; vertical-align: bottom">
                            <strong>
                                Karma?
                            </strong>
                            <select class="Metric" name="attr_Metric" style= "width: 55px; height: 23px">
                                <option value="No">
                                    No
                                </option>
                                <option value="Yes">
                                    Yes
                                </option>
                            </select>
                        </td>
                        <td style="text-align: center; vertical-align: bottom">
                            <input name="attr_InitMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_InitStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Initiative**
--Step|[[ ?{Step|@{InitTotal}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [TRKR] [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td style="vertical-align: top;"> <!-- Defenses Table -->
            <table style="width: 360px; height: 100%; float: left; background-color: #FFFFFF;" border="5" cellpadding="3">
            <tbody>
                <tr style="background-color: #f3e5d8;">
                    <td style="width: 24%;">
                    </td>
                    <td style="vertical-align: bottom; text-align: center; height:15px" colspan="2">
                        <strong>
                            DEFENSE
                        </strong>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 40%" colspan="2">
                        <strong>
                            ARMOR
                        </strong>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: bottom; text-align: right; height:15px">
                        <strong>
                            Physical
                        </strong>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 19%;">
                        <strong>Base</strong>
                        <input name="attr_PD_max" type="number" value="6" style="width: 41px;"/>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 19%;">
                        <strong>Current</strong>
                        <input name="attr_PD" type="number" value="6" style="width: 45px;"/>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 21%;">
                        <strong>Base</strong>
                        <input name="attr_PA_max" type="number" value="0" style="width: 41px;"/>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 19%;">
                        <strong>Current</strong>
                        <input name="attr_PA" type="number" value="0" style="width: 45px;"/>
                    </td>
                </tr>
                <tr style="background-color: #f3e5d8;">
                    <td style="vertical-align: center; text-align: right;">
                        <strong>
                            Mystic
                        </strong>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_MD_max" type="number" value="6" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_MD" type="number" value="6" style="width: 45px;"/>
                    </td>
                    <td style="text-align: center;" />
                        <input name="attr_MA_max" type="number" value="2" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_MA" type="number" value="2" style="width: 45px;"/>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: center; text-align: right;">
                        <strong>
                            Social
                        </strong>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_SD_max" type="number" value="6" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_SD" type="number" value="6" style="width: 45px;"/>
                    </td>
                    <td style="text-align: center; vertical-align: top;" colspan="2">
                         
                    </td>
                </tr>
                <tr style="background-color: #f3e5d8;">
                    <td>
                        <strong>
                            Race
                        </strong>
                    </td>
                    <td colspan="2">
                        <input name="attr_Race" type="text" style="width:100px;"/>
                    </td>
                    <td>
                        <strong>
                            Karma Step
                        </strong>
                    </td>
                    <td style="width: 50px; vertical-align: center;">
                        <input name="attr_KarmaStep" type="number" value="4" style="width: 41px;"/>
                    </td>
                </tr>
                <tr>
                    <td style="width: 73px;">
                        <strong>
                            Discipline 1
                        </strong>
                    </td>
                    <td colspan="2">
                        <input name="attr_Discipline1" type="text" style="width:100px"/>
                    </td>
                    <td>
                        <strong>
                            Circle
                        </strong>
                    </td>
                    <td>
                        <input name="attr_Dis1Circle" type="number" value="1" style="width: 41px;"/>
                    </td>
                </tr>
                <tr style="background-color: #f3e5d8;">
                    <td>
                        <strong>
                            Discipline 2
                        </strong>
                    </td>
                    <td colspan="2">
                        <input name="attr_Discipline2" type="text" style="width:100px"/>
                    </td>
                    <td>
                        <strong>
                            Circle
                        </strong>
                    </td>
                    <td>
                        <input name="attr_Dis2Circle" type="number" value="0" style="width: 41px;"/>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: middle;">
                        <strong>
                            Recovery
                        </strong>
                    </td>
                    <td style="text-align: center; vertical-align: bottom;">
                        <strong>
                            Per Day
                        </strong>
                        <input name="attr_Recovery_max" type="number" value="1" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center; vertical-align: bottom;">
                        <strong>
                            Current
                        </strong>
                        <input name="attr_Recovery" type="number" value="1" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center; vertical-align: bottom;">
                        <strong>
                            Karma?
                        </strong>
                        <select class="RecoveryKarma" name="attr_RecoveryKarma" style= "width: 55px; height: 23px">
                            <option value="No">
                                No
                            </option>
                            <option value="Yes">
                                Yes
                            </option>
                        </select>
                    </td>
                    <td style="text-align: center; vertical-align: middle;">
                        <span style="background-color: #ff0000;">
                            <button name="roll_Recovery" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Recovery**
--Step|[[ ?{Step|@{TouStep}+@{TouMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
--Recovery|-1
}}">
                            </button>
                        </span>
                    </td>
                </tr>
            </tbody>
        </table>
    </td>
</tr>
</tbody>
</table>
<p></p>
<h3>Special Abilities</h3>
<fieldset class="repeating_specials">
<table style="width: 725px; height: 50px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="2">
                <tbody>
                    <tr>
                        <td style="text-align: left; vertical-align: top; width: 70px">
                            <strong>
                                EFFECT
                            </strong>
                        </td>
                        <td style="vertical-align: top;">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_SpecialEffect"></textarea>
                        </td>
                        <td style="text-align: left; vertical-align: top; width: 70px">
                            <strong>
                                SOURCE
                            </strong>
                        </td>
                        <td style="vertical-align: top;">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_SpecialSource"></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
</div>
<div class="sheet-section-talents"> <!-- Talents Tab -->
<p></p>
<fieldset class="repeating_talents">
<table style="width: 725px; height: 100px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
                <tbody>
                    <tr style="background-color: #ffa31a;">
                        <td style="text-align: left; vertical-align: bottom; width: 140px;">
                            <strong>
                                TALENT
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STEP
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                RANK
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 70px">
                            <strong>
                                ACTION
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STRAIN
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 75px">
                            <strong>
                                Vs DEFENSE
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 200px">
                            <strong>
                                ROLL
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 170px">
                            <strong>
                                DURATION
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_TalentName" type="text" style= "width: 140px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_TalentStep" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_TalentRank" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="TalentAction" name="attr_TalentAction" style= "width: 81px">
                                <option value="Free">
                                    Free
                                </option>
                                <option value="Simple">
                                    Simple
                                </option>
                                <option value="Standard">
                                    Standard
                                </option>
                                <option value="Sustained">
                                    Sustained
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_TalentStrain" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="TalentDefense" name="attr_TalentDefense" style= "width: 72px">
                                <option value="None">
                                    None
                                </option>
                                <option value="@{target|PD}">
                                    Physical
                                </option>
                                <option value="@{target|MD}">
                                    Mystic
                                </option>
                                <option value="@{target|SD}">
                                    Social
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            Public/GM Only/Target<br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_TalentStep" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{TalentName}**
--Step|[[ ?{Step|@{TalentStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{TalentStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{TalentDurationTotal} > 0 ?? Duration| @{TalentDurationTotal} @{TalentDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #f4c542;">
                                <button name="roll_TalentStepGM" type="roll" value="!power {{
--whisper|GM
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{TalentName}**
--Step|[[ ?{Step|@{TalentStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{TalentStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{TalentDurationTotal} > 0 ?? Duration| @{TalentDurationTotal} @{TalentDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #004fce;">
                                <button name="roll_TalentTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{TalentName}**
--leftsub|vs @{target|token_name}
--Step|[[ ?{Step|@{TalentStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{TalentStrain}} ]] Strain
--Successes|[[ {0d1, floor(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{TalentDefense}) /5 +1) }kh1 ]]
--?? @{TalentDurationTotal} > 0 ?? Duration| @{TalentDurationTotal} @{TalentDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                        <td style="vertical-align: top; text-align: center;" rowspan="2">
                                <input name="attr_TalentDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                                <strong>+</strong>
                                <select class="TalentDurationRank" name="attr_TalentDurationRank" style= "width: 53px">
                                    <option value="0">
                                        Zero
                                    </option>
                                    <option value="@{TalentRank}">
                                        Rank
                                    </option>
                                </select>
                                <strong>=</strong><br/>
                                <input disabled="disabled" name="attr_TalentDurationTotal" type="number" style="vertical-align: top; width: 41px;" value="@{TalentDurationNumber}+@{TalentDurationRank}">
                                <select class="TalentDurationIncrement" name="attr_TalentDurationIncrement" style= "width: 70px">
                                    <option value="Rounds">
                                        Rounds
                                    </option>
                                    <option value="Minutes">
                                        Minutes
                                    </option>
                                    <option value="Hours">
                                        Hours
                                    </option>
                                    <option value="Days">
                                        Days
                                    </option>
                                </select>
                            </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;" rowspan="1">
                            <strong>
                                DESCRIPTION
                            </strong>
                        </td>
                        <td style="text-align: left; vertical-align: top;" colspan="6" rowspan="1">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_TalentDesc"></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
<p></p>
</div>
<div class="sheet-section-skills"> <!-- Skills Tab -->
<p></p>
<fieldset class="repeating_skills">
<table style="width: 725px; height: 100px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
                <tbody>
                    <tr style="background-color: #009900; color: #FFFFFF;">
                        <td style="text-align: left; vertical-align: bottom; width: 140px;">
                            <strong>
                                SKILL
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STEP
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                RANK
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 70px">
                            <strong>
                                ACTION
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STRAIN
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 75px">
                            <strong>
                                Vs DEFENSE
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 200px">
                            <strong>
                                ROLL
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 170px">
                            <strong>
                                DURATION
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_SkillName" type="text" style= "width: 140px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_SkillStep" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_SkillRank" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="SkillAction" name="attr_SkillAction" style= "width: 81px">
                                <option value="Free">
                                    Free
                                </option>
                                <option value="Simple">
                                    Simple
                                </option>
                                <option value="Standard">
                                    Standard
                                </option>
                                <option value="Sustained">
                                    Sustained
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_SkillStrain" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="SkillDefense" name="attr_SkillDefense" style= "width: 72px">
                                <option value="None">
                                    None
                                </option>
                                <option value="@{target|PD}">
                                    Physical
                                </option>
                                <option value="@{target|MD}">
                                    Mystic
                                </option>
                                <option value="@{target|SD}">
                                    Social
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            Public/GM Only/Target<br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_SkillStep" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SkillName}**
--Step|[[ ?{Step|@{SkillStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{SkillStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SkillDurationTotal} > 0 ?? Duration| @{SkillDurationTotal} @{SkillDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #f4c542;">
                                <button name="roll_SkillStepGM" type="roll" value="!power {{
--whisper|GM
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SkillName}**
--Step|[[ ?{Step|@{SkillStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{SkillStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{SkillDurationTotal} > 0 ?? Duration| @{SkillDurationTotal} @{SkillDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #004fce;">
                                <button name="roll_SkillTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SkillName}**
--leftsub|vs @{target|token_name}
--Step|[[ ?{Step|@{SkillStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{SkillStrain}} ]] Strain
--Successes|[[ {0d1, floor(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SkillDefense}) /5 +1) }kh1 ]]
--?? @{SkillDurationTotal} > 0 ?? Duration| @{SkillDurationTotal} @{SkillDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                        <td style="vertical-align: top; text-align: center;" rowspan="2">
                                <input name="attr_SkillDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                                <strong>+</strong>
                                <select class="SkillDurationRank" name="attr_SkillDurationRank" style= "width: 53px">
                                    <option value="0">
                                        Zero
                                    </option>
                                    <option value="@{SkillRank}">
                                        Rank
                                    </option>
                                </select>
                                <strong>=</strong><br/>
                                <input disabled="disabled" name="attr_SkillDurationTotal" type="number" style="vertical-align: top; width: 41px;" value="@{SkillDurationNumber}+@{SkillDurationRank}">
                                <select class="SkillDurationIncrement" name="attr_SkillDurationIncrement" style= "width: 70px">
                                    <option value="Rounds">
                                        Rounds
                                    </option>
                                    <option value="Minutes">
                                        Minutes
                                    </option>
                                    <option value="Hours">
                                        Hours
                                    </option>
                                    <option value="Days">
                                        Days
                                    </option>
                                </select>
                            </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;" rowspan="1">
                            <strong>
                                DESCRIPTION
                            </strong>
                        </td>
                        <td style="text-align: left; vertical-align: top;" colspan="6" rowspan="1">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_SkillDesc"></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
<p></p>
</div>
<div class="sheet-section-equipment"> <!-- Equipment Tab -->
<h3>
Melee Weapons
</h3>
<fieldset class="repeating_meleeweapons">
<table style="width: 725px; height: 70px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; background-color: #FFFFFF;" border="5">
                <tbody>
                    <tr style="background-color: #bfbfbf">
                        <td style="text-align: left; vertical-align: bottom; width: 150px" >
                            <strong>
                                NAME
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 50px">
                            <strong>
                                STEP
                            </strong>
                        <td style="vertical-align: bottom; text-align: center; width: 50px">
                            <strong>
                                Vs DEFENSE
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 80px">
                            <strong>
                                ATTACK
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 50px; color: #eaeaea; background-color: #dd0000">
                            <strong>
                                STEP
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 50px; color: #eaeaea; background-color: #dd0000">
                            <strong>
                                Vs ARMOR
                            </strong>
                        </td>                        
                        <td style="vertical-align: bottom; text-align: center; width: 80px; color: #eaeaea; background-color: #dd0000">
                            <strong>
                                DAMAGE
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_WeaponName" type="text" style= "width: 150px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_AtkStep" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="WeaponDefense" name="attr_WeaponDefense" style= "width: 72px">
                                <option value="@{target|PD}">
                                    Physical
                                </option>
                                <option value="@{target|MD}">
                                    Mystic
                                </option>
                                <option value="@{target|SD}">
                                    Social
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            Public / Target <br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_AtkStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{WeaponName}**
--leftsub|Attack
--Step|[[ ?{Step|@{AtkStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #004fce;">
                                <button name="roll_AtkTarget" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{WeaponName}**
--leftsub|Attack vs @{target|token_name}
--Step|[[ ?{Step|@{AtkStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Successes|[[ {0d1, floor(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{WeaponDefense}) /5 +1) }kh1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_DamStep" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="WeaponDamType" name="attr_WeaponDamType" style= "width: 72px">
                                <option value="@{target|PA}">
                                    Physical
                                </option>
                                <option value="@{target|MA}">
                                    Mystic
                                </option>
                            </select>
                        </td>                        
                        <td style="vertical-align: top; text-align: center;">
                            Public / Target <br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_DamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{WeaponName}**
--leftsub|Damage
--Step|[[ ?{Step|@{DamStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #004fce;">
                                <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{WeaponName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{DamStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{WeaponDamType}) ) }kh1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;" rowspan="1">
                            <strong>
                                SPECIAL
                            </strong>
                        </td>
                        <td style="text-align: left; vertical-align: top" colspan="6" rowspan="1">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_MWeaponSpecial"></textarea>
                        </td>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
<p></p>
<h3>
Ranged Weapons
</h3>
    <table style="width: 725px; height: 70px; background-color: #FFFFFF;" border="5">
        <tbody>
            <tr style="background-color: #bfbfbf">
                <td style="text-align: left; vertical-align: bottom; width: 150px" >
                    <strong>
                        NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: center; width: 40px; ">
                    <strong>
                        STEP
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: center; width: 50px; ">
                    <strong>
                        Vs DEFENSE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: center; width: 80px; ">
                    <strong>
                        ATTACK
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: center; width: 40px; color: #eaeaea; background-color: #dd0000">
                    <strong>
                        STEP
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: center; width: 50px; color: #eaeaea; background-color: #dd0000">
                    <strong>
                        Vs ARMOR
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: center; width: 80px; color: #eaeaea; background-color: #dd0000">
                    <strong>
                        DAMAGE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: center; width: 45px">
                    <strong>
                        RANGE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: center; width: 45px">
                    <strong>
                        AMMO
                    </strong>
                </td>
            </tr>
            <tr>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_RWeaponName" type="text" style= "width: 150px"/>
                </td>
                <td style="vertical-align: top; text-align: center;">
                    <input name="attr_RAtkStep" type="number" value="0" style="width: 41px;"/>
                </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="RWeaponDefense" name="attr_RWeaponDefense" style= "width: 72px">
                                <option value="@{target|PD}">
                                    Physical
                                </option>
                                <option value="@{target|MD}">
                                    Mystic
                                </option>
                                <option value="@{target|SD}">
                                    Social
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            Public / Target <br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_RAtkStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{RWeaponName}**
--leftsub|Attack
--Step|[[ ?{Step|@{RAtkStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #004fce;">
                                <button name="roll_RAtkTarget" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{RWeaponName}**
--leftsub|Attack vs @{target|token_name}
--Step|[[ ?{Step|@{RAtkStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Successes|[[ {0d1, floor(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{RWeaponDefense}) /5 +1) }kh1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_RDamStep" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="RWeaponDamType" name="attr_RWeaponDamType" style= "width: 72px">
                                <option value="@{target|PA}">
                                    Physical
                                </option>
                                <option value="@{target|MA}">
                                    Mystic
                                </option>
                            </select>
                        </td>                        
                        <td style="vertical-align: top; text-align: center;">
                            Public / Target <br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_RDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{RWeaponName}**
--leftsub|Damage
--Step|[[ ?{Step|@{RDamStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #004fce;">
                                <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{RWeaponName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{RDamStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{RWeaponDamType}) ) }kh1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                <td style="vertical-align: top; text-align: center;">
                    <strong>
                        Short
                    </strong>
                    <input name="attr_RangeShort" type="number" value="2" style="width: 40px;"/>
                </td>
                <td style="vertical-align: top; text-align: center;">
                    <strong>
                        Current
                    </strong>
                    <input name="attr_Arrow" type="number" value="0" style="width: 40px;"/>
                </td>
            </tr>
            <tr>
                <td style="text-align: left; vertical-align: top;" rowspan="1">
                    <strong>
                        SPECIAL
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top" colspan="6" rowspan="1">
                    <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_RWeaponSpecial"></textarea>
                </td>
                <td style="vertical-align: top; text-align: center;">
                    <strong>
                        Long
                    </strong>
                    <input name="attr_RangeLong" type="number" value="4" style="width: 40px;"/>
                </td>                        
                <td style="vertical-align: top; text-align: center;">
                    <strong>
                        Max
                    </strong>
                    <input name="attr_Arrow_max" type="number" value="0" style="width: 40px;"/>
                </td>
            </tr>
        </tbody>
    </table>
<p></p>
<table style="width: 725px; height: 80px">
    <tr>
        <td>
            <h3>
                Armor
            </h3>
            <table style="width: 350px; height: 100%; background-color: #FFFFFF;" border="5">
                <tbody>
                    <tr style="background-color: #bfbfbf">
                        <td style="text-align: left; vertical-align: bottom; width: 110px" >
                            <strong>
                                NAME
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>
                                PA
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>
                                MA
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>
                                INIT
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_ArmorName" type="text" style= "width: 100px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ArmorPA" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ArmorMA" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ArmorInitMod" type="number" value="0" style="width: 41px;"/>
                        </td>                       
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;" rowspan="1">
                            <strong>
                                SPECIAL
                            </strong>
                        </td>
                        <td style="text-align: left; vertical-align: top" colspan="3" rowspan="1">
                           <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_ArmorSpecial"></textarea>
                       </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
            <h3>
            Shield
            </h3>
            <table style="width: 350px; height: 100%; background-color: #FFFFFF;" border="5">
                <tbody>
                    <tr style="background-color: #bfbfbf">
                        <td style="text-align: left; vertical-align: bottom; width: 110px" >
                            <strong>
                                NAME
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>
                                PD
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>
                                MD
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>
                                INIT
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>
                                SHATTER
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_ShieldName" type="text" style= "width: 100px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ShieldPD" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ShieldMD" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ShieldInitMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_ShieldShatter" type="number" value="0" style="width: 41px;"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;" rowspan="1">
                            <strong>
                                SPECIAL
                            </strong>
                        </td>
                        <td style="text-align: left; vertical-align: top" colspan="4" rowspan="1">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_ShieldSpecial"></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</table>
<p></p>
<h3>Thread Items</h3>
<fieldset class="repeating_threaditems">
    <table style="width: 725px; height: 80px;" border="1">
        <tbody>
            <tr>
                <td>
                    <table style="width: 100%; height: 100%; background-color: #FFFFFF;" border="5">
                        <tbody>
                            <tr style="background-color: #bfbfbf">
                                <td style="text-align: left; vertical-align: bottom; height: 15px; width: 200px;" >
                                    <strong>NAME</strong></td>
                                <td style="text-align: center;">
                                    <strong>RANK</strong></td>
                                <td style="text-align: center;">
                                    <strong>MAX THREADS</strong></td>
                                <td style="text-align: center;">
                                    <strong>MD</strong></td>
                                <td style="text-align: center;">
                                    <strong>TIER</strong></td>
                            </tr>
                            <tr>
                                <td style="text-align: left; vertical-align: top; height: 15px" >
                                    <input name="attr_TIName" type="text" style= "width: 150px"/>
                                </td>
                                <td style="text-align: center; vertical-align: top; height: 15px" >
                                    <input name="attr_TIRank" type="number" value="0" style="width: 41px;"/>
                                <td style="text-align: center; vertical-align: top; height: 15px" >
                                    <input name="attr_TIMaxThreads" type="number" value="0" style="width: 41px;"/>
                                </td>
                                <td style="text-align: center; vertical-align: top; height: 15px" >
                                    <input name="attr_TIMD" type="number" value="0" style="width: 41px;"/>
                                </td>
                                <td style="text-align: center; vertical-align: top; height: 15px" >
                                    <select class="TITier" style="width: 90px;" name="attr_TITier">
                                        <option value="Novice">
                                            Novice
                                        </option>
                                        <option value="Journeman">
                                            Journeman
                                        </option>
                                        <option value="Warden">
                                            Warden
                                        </option>
                                        <option value="Master">
                                            Master
                                        </option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td style="text-align: left; vertical-align: top;">
                                    <strong>
                                        THREAD DETAILS
                                    </strong>
                                </td>
                                <td style="text-align: left; vertical-align: top" colspan="4">
                                    <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_TIInfo"></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-matrixes"> <!-- Matrixes Tab -->
<p></p>
<table style="width: 725px; height: 80%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tr style="height: 10px; background-color: #ffa31a;">
            <td style="text-align: left; vertical-align: bottom; width: 163px">
                <strong>
                    NAME
                </strong>
            </td>
            <td style="vertical-align: bottom; text-align: center; width: 111px">
                <strong>
                    STEP
                </strong>
            </td>
            <td style="vertical-align: bottom; text-align: center; width: 113px">
                <strong>
                    RANK
                </strong>
            </td>
            <td style="vertical-align: bottom; text-align: center; width: 133px">
                <strong>
                    ACTION
                </strong>
            </td>
            <td style="vertical-align: bottom; text-align: center; width: 140px">
                <strong>
                    ROLL
                </strong>
            </td>
        </tr>
        <tr style="height: 10px">
            <td style="text-align: left;" >
                <strong>Spellcasting</strong>
            </td>
            <td style="text-align: center;">
                <input name="attr_SCStep" type="number" value="0" style="width: 41px;">
            </td>
            <td style="text-align: center;">
                <input name="attr_SCRank" type="number" value="0" style="width: 41px;"/>
            </td>
            <td style="text-align: center;">
                Standard
            </td>
            <td style="text-align: center;">
                Public / GM Only / Target <br/>
                <span style="background-color: #ff0000;">
                    <button name="roll_SCStep" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Spellcasting**
--Step|[[ ?{Step|@{SCStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
                &nbsp;
                <strong>/</strong>
                &nbsp;
                <span style="background-color: #f4c542;">
                    <button name="roll_SCStepGM" type="roll" value="!power {{
--whisper|GM
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Spellcasting**
--Step|[[ ?{Step|@{SCStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
                &nbsp;
                <strong>/</strong>
                &nbsp;
                <span style="background-color: #004fce;">
                    <button name="roll_SCTarget" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Spellcasting**
--leftsub| vs @{target|token_name}
--Step|[[ ?{Step|@{SCStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Successes|[[ {0d1, floor(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{target|MD}) /5 +1) }kh1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
            </td>
        </tr>
</table>
<fieldset class="repeating_threadweaving">
    <table style="width: 725px; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tr style="height: 10px">
            <td style="text-align: left; width: 160px">
                <input name="attr_TWName" type="text" style= "width: 140px"/>
            </td>
            <td style="text-align: center; width: 110px" />
                <input name="attr_TWStep" type="number" value="0" style="width: 41px;"/>
            </td>
            <td style="text-align: center; width: 110px">
                <input name="attr_TWRank" type="number" value="0" style="width: 41px;"/>
            </td>
            <td style="text-align: center; width: 130px">
                <select class="TalentAction" name="attr_TalentAction" style= "width: 81px">
                    <option value="Free">
                        Free
                    </option>
                    <option value="Simple">
                        Simple
                    </option>
                    <option value="Standard">
                        Standard
                    </option>
                    <option value="Sustained">
                        Sustained
                    </option>
                </select>
            </td>
            <td style="text-align: center; width: 140px">
                    Public / GM Only / Target <br/>
                <span style="background-color: #ff0000;">
                    <button name="roll_TWStep" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{TWName}**
--Step|[[ ?{Step|@{TWStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
                &nbsp;
                <strong>/</strong>
                &nbsp;
                <span style="background-color: #f4c542;">
                    <button name="roll_TWStepGM" type="roll" value="!power {{
--whisper|GM
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{TWName}**
--Step|[[ ?{Step|@{TWStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
                &nbsp;
                <strong>/</strong>
                &nbsp;
                <span style="background-color: #004fce;">
                    <button name="roll_SCTarget" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{TWName}**
--leftsub| vs @{target|token_name}
--Step|[[ ?{Step|@{TWStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Successes|[[ {0d1, floor(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{target|MD}) /5 +1) }kh1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                </span>
            </td>
        </tr>
    </table>
</fieldset>
<h3>Matrixes</h3>
<fieldset class="repeating_matrixes">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: center; width: 5%; background-color: #ffa31a;">
                    <strong>
                        TYPE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 24%; background-color: #ffa31a;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 25%; background-color: #ffa31a;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 15%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 36%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: top; text-align: left; background-color: #ffa31a;">
                    <select class="MatrixType" style="width: 81px;" name="attr_MatrixType">
                        <option value="Standard">
                            Standard
                        </option>
                        <option value="Enhanced">
                            Enhanced
                        </option>
                        <option value="Armored">
                            Armored
                        </option>
                        <option value="Shared">
                            Shared
                        </option>
                    </select>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top; width: 41px;" value="1">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 53px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 69px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style= "text-align: center; background-color: #ffa31a;">
                    <strong>
                        RANK
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style= "vertical-align: top; text-align: center; background-color: #ffa31a;" rowspan=2>
                    <input name="attr_MatrixRank" type="number" value="0" style="width: 41px;">
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 72px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-grimoire"> <!-- Grimoire Tab -->
<p></p>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab51" value="51" title="Circle1" checked="checked" />
    <span class="sheet-tab sheet-tab51">Circle 1</span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab52" value="52" title="Circle2" />
    <span class="sheet-tab sheet-tab52">Circle 2</span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab53" value="53" title="Circle3" />
    <span class="sheet-tab sheet-tab53">Circle 3</span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab54" value="54" title="Circle4" />
    <span class="sheet-tab sheet-tab54">Circle 4</span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab55" value="55" title="Circle5" />
    <span class="sheet-tab sheet-tab55">Circle 5</span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab56" value="56" title="Circle6" />
    <span class="sheet-tab sheet-tab56">Circle 6</span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab57" value="57" title="Circle7" />
    <span class="sheet-tab sheet-tab57">Circle 7</span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab58" value="58" title="Circle8" />
    <span class="sheet-tab sheet-tab58">Circle 8</span>
    <p></p>

<div class="sheet-section-circle1">
<fieldset class="repeating_spells1">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 24%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 25%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 15%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 36%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="1" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 53px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 69px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 72px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-circle2">
<fieldset class="repeating_spells2">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 24%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 25%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 15%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 36%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="2" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 53px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 69px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 72px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-circle3">
<fieldset class="repeating_spells3">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 24%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 25%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 15%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 36%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="3" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 53px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 69px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 72px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-circle4">
<fieldset class="repeating_spells4">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 24%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 25%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 15%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 36%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="4" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 53px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 69px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 72px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-circle5">
<fieldset class="repeating_spells5">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 24%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 25%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 15%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 36%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="5" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 53px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 69px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 72px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-circle6">
<fieldset class="repeating_spells6">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 24%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 25%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 15%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 36%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="6" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 53px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 69px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 72px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-circle7">
<fieldset class="repeating_spells7">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 24%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 25%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 15%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 36%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="7" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 53px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 69px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 72px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
<div class="sheet-section-circle8">
<fieldset class="repeating_spells8">
    <table style="width: 725px; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
        <tbody>
            <tr style="height: 10px;">
                <td style="vertical-align: bottom; text-align: left; width: 24%; background-color: #bfbfbf;">
                    <strong>
                         SPELL NAME
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 25%; background-color: #bfbfbf;">
                    <input name="attr_SpellName" type="text" style= "width: 160px" />
                </td>
                <td style="vertical-align: bottom; text-align: right; width: 15%">
                    <strong>
                         RANGE
                    </strong>
                </td>
                <td style="vertical-align: bottom; text-align: left; width: 36%" />
                    <input name="attr_SpellRange" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style="height: 10px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                         CIRCLE
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCircle" type="number" style="vertical-align: top;" value="8" disabled="true">
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                         DURATION
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                    <strong>+</strong>
                    <select class="SpellDurationRank" name="attr_SpellDurationRank" style= "width: 53px">
                        <option value="0">
                            Zero
                        </option>
                        <option value="@{SCRank}">
                            Rank
                        </option>
                    </select>
                    <select class="SpellDurationIncrement" name="attr_SpellDurationIncrement" style= "width: 69px">
                        <option value="Rounds">
                            Rounds
                        </option>
                        <option value="Minutes">
                            Minutes
                        </option>
                        <option value="Hours">
                            Hours
                        </option>
                    </select>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="vertical-align: center; text-align: left;">
                    <strong>
                        THREADS
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellThreads" type="number" value="0" style="width: 41px;"/>
                    TN
                    <input type="number" name="attr_SpellWeave" value="(@{SpellCircle}+4)" disabled="true" />
                    <strong>/</strong>
                    <input type="number" name="attr_SpellAttune" value="@{SpellCircle}+9" disabled="true" />
                </td>
                <td style="vertical-align: center; text-align: right;">
                    <strong>
                        CASTING
                    </strong>
                </td>
                <td style="vertical-align: center; text-align: left;">
                    <input name="attr_SpellCastTN" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 10px;">
                <td style="vertical-align: top; text-align: left;">
                    <strong>
                        EXTRA THREADS
                    </strong>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellXThreads"></textarea>
                </td>
                <td style="vertical-align: top; text-align: right;">
                    <strong>
                        SUCCESS LEVELS
                    </strong>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <input name="attr_SpellXSuc" type="text" style= "width: 150px"/>
                </td>
            </tr>
            <tr style= "height: 30px;">
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        DAMAGE
                    </strong>
                        <br/> Public / GM Only / Target <br/>
                    <span style="background-color: #ff0000;">
                    <button name="roll_SpellDamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                    <button name="roll_GMSpellDamStep" type="roll" value="!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                    </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #004fce;">
                        <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{WilStep}+@{WilMod}+@{SpellDamage}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{SpellDamType}) ) }kh1 ]]
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                        </button>
                    </span>
                </td>
                <td style="vertical-align: top; text-align: left;">
                    <strong>WIL +</strong>
                    <input name="attr_SpellDamage" type="number" value="0" style="width: 41px;"/>
                        <strong>/</strong>
                    <select class="SpellDamType" name="attr_SpellDamType" style= "width: 72px">
                        <option value="@{target|PA}">
                            Physical
                        </option>
                        <option value="@{target|MA}">
                            Mystic
                        </option>
                        <option value="Effect">
                            Effect
                        </option>
                    </select>
                </td>
                <td style="text-align: center; vertical-align: top;">
                    <strong>
                        EFFECT
                    </strong>
                        <br/> Public / GM Only <br/>
                    <span style="background-color: #ff0000;">
                        <button name="roll_SpellEffectCard" type="roll" value="!power {{
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                    &nbsp;
                    <strong>/</strong>
                    &nbsp;
                    <span style="background-color: #f4c542;">
                        <button name="roll_GMSpellEffectCard" type="roll" value="!power {{
--whisper|GM
--format|blue
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{SpellName}**
--Effect|[[ ?{Modifier #|@{SpellEffectNumber}}]] @{SpellEffect}
--Duration|[[ ?{Duration #|@{SpellDurationNumber}+@{SpellDurationRank}}]] ?{Time Frame|@{SpellDurationIncrement}}
}}">
                        </button>
                    </span>
                </td>
                <td style="text-align: left; vertical-align: top;">
                    <input name="attr_SpellEffectNumber" type="number" value="0" style="width: 41px;"/>
                    <textarea class="text-input-noback" style="width:130px; height:20px" name="attr_SpellEffect"></textarea>
                </td>
            </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</fieldset>
</div>
</div>
<div class="sheet-section-treasury"> <!-- Treasury Tab -->
<p></p>
<h3>
    Total Legend Points <input name="attr_LegendPoints" style="width: 100px;" type="number" value="0" />
    Renown <input name="attr_Renown" type="number" value="16" />
    Reputation <input name="attr_Reputation" type="number" value="0" style="width: 41px;"/>
</h3>
<p></p>
<table style="width: 725px;" cellspacing="1" cellpadding="1">
    <tr>
        <td style="vertical-align: top">
            <h3>
                Total Silver Value
                <input disabled="disabled" style="width: 100px" name="attr_TotalSilver" type="number" value="(@{Copper}/10)+@{Silver}+(@{Gold}*10)+(@{EarthCoin}*100)+(@{WaterCoin}*100)+(@{AirCoin}*1000)+(@{FireCoin}*1000)+(@{OrichalcumCoin}*10000)" />
            </h3>
        </td>
        <td></td>
        <td>
            <h3>
                Carrying Capacity <input name="attr_CarryCap" style="width: 50px;" type="number" value="80"/>
            </h3>
        </td>
    </tr>
    <tr>
        <td>
            <table style="width: 250px; background-color: #FFFFFF;" border="1" cellspacing="0" cellpadding="2">
                <tbody>
                    <tr>
                        <td>
                        <strong>
                            COINS
                        </strong>
                        </td>
                        <td style="text-align: center">
                            <strong>Number</strong>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td>
                            Copper
                        </td>
                        <td style="text-align: center">
                            <input name="attr_Copper" type="number" value="0" style="width: 100px;" />
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Silver
                        </td>
                        <td style="text-align: center">
                            <input name="attr_Silver" type="number" value="0" style="width: 100px;"/>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td>
                            Gold
                        </td>
                        <td style="text-align: center">
                            <input name="attr_Gold" type="number" value="0" style="width: 100px;"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Earth Coin
                        </td>
                        <td style="text-align: center">
                            <input name="attr_EarthCoin" type="number" value="0" style="width: 100px;"/>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td>
                            Water Coin
                        </td>
                        <td style="text-align: center">
                            <input name="attr_WaterCoin" type="number" value="0" style="width: 100px;"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Air Coin
                        </td>
                        <td style="text-align: center">
                            <input name="attr_AirCoin" type="number" value="0" style="width: 100px;"/>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td>
                            Fire Coin
                        </td>
                        <td style="text-align: center">
                            <input name="attr_FireCoin" type="number" value="0" style="width: 100px;"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Orichalcum Coin
                        </td>
                        <td style="text-align: center">
                            <input name="attr_OrichalcumCoin" type="number" value="0" style="width: 100px;"/>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td style="width: 50px">
        </td>
    <td style="vertical-align: top;">
        <h3>Miscelaneous Gear</h3>
        <textarea class="text-input-noback" style="width:350px; height:20px" name="attr_MiscTreasure"></textarea>
    </td>
    </tr>
</table>
<p></p>
    </div>
<div class="sheet-section-NPC"><!-- NPC Tab -->
<p></p>
<table style="width: 725px; height: 250px;" cellpadding="0"> <!-- NPC Attributes & Defenses table -->
    <tbody>
        <tr>
            <td style="vertical-align: top;">
                <table style="width: 355px; height: 100%; background-color: #FFFFFF;" border="5" cellpadding="3"> <!-- NPC Attributes Table -->
                <tbody>
                    <tr style="background-color: #f3e5d8;">
                        <td style="vertical-align: bottom; text-align: center; height:15px; width: 35%">
                            <blockquote>
                                <strong>
                                    ATTRIBUTES
                                </strong>
                            </blockquote>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 38%" colspan="2">
                            <blockquote>
                                <strong>
                                    STEP
                                </strong>
                            </blockquote>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 27%">
                            <blockquote>
                                <strong>
                                    ROLL
                                </strong>
                            </blockquote>
                        </td>
                    </tr>
                    <tr>
                        <td style="vertical-align: bottom; text-align: left; height:15px">
                            <strong>
                                Dexterity
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center">
                            <strong>Base</strong>
                            <input name="attr_DexStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <strong>Modifier</strong>
                            <input name="attr_DexMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: bottom; text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_DexStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Dexterity**
--Step|[[ ?{Step|@{DexStep}+@{DexMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td style="text-align: left;">
                            <strong>
                                Strength
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_StrStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_StrMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_StrStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Strength**
--Step|[[ ?{Step|@{StrStep}+@{StrMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>
                                Toughness
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_TouStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_TouMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_TouStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Toughness**
--Step|[[ ?{Step|@{TouStep}+@{TouMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td style="text-align: left;">
                            <strong>
                                Perception
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_PerStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_PerMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_PerStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Perception**
--Step|[[ ?{Step|@{PerStep}+@{PerMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>
                                Willpower
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_WilStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_WilMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_WilStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Willpower**
--Step|[[ ?{Step|@{WilStep}+@{WilMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr style="background-color: #f3e5d8;">
                        <td style="text-align: left;">
                            <strong>
                                Charisma
                            </strong>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_ChaStep" type="number" value="5" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <input name="attr_ChaMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_ChaStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Charisma**
--Step|[[ ?{Step|@{ChaStep}+@{ChaMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>
                                Initiative
                            </strong>
                        </td>
                        <td style="text-align: center; vertical-align: bottom">
                            <strong>
                                Armor Mod
                            </strong>
                            <input name="attr_ArmorMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center; vertical-align: bottom">
                            <input name="attr_InitMod" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="text-align: center;">
                            <span style="background-color: #ff0000;">
                                <strong>
                                    <button name="roll_InitStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Initiative**
--Step|[[ ?{Step|@{InitTotal}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [TRKR] [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                    </button>
                                </strong>
                            </span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td style="vertical-align: top;"> <!-- NPC Defenses Table -->
            <table style="width: 360px; height: 100%; float: left; background-color: #FFFFFF;" border="5" cellpadding="3">
            <tbody>
                <tr style="background-color: #f3e5d8;">
                    <td style="width: 24%;">
                    </td>
                    <td style="vertical-align: bottom; text-align: center; height:15px" colspan="2">
                        <strong>
                            DEFENSE
                        </strong>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 40%" colspan="2">
                        <strong>
                            ARMOR
                        </strong>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: bottom; text-align: right; height:15px">
                        <strong>
                            Physical
                        </strong>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 19%;">
                        <strong>Base</strong>
                        <input name="attr_PD_max" type="number" value="6" style="width: 41px;"/>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 19%;">
                        <strong>Current</strong>
                        <input name="attr_PD" type="number" value="6" style="width: 45px;"/>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 21%;">
                        <strong>Base</strong>
                        <input name="attr_PA_max" type="number" value="0" style="width: 41px;"/>
                    </td>
                    <td style="vertical-align: bottom; text-align: center; width: 19%;">
                        <strong>Current</strong>
                        <input name="attr_PA" type="number" value="0" style="width: 45px;"/>
                    </td>
                </tr>
                <tr style="background-color: #f3e5d8;">
                    <td style="vertical-align: center; text-align: right;">
                        <strong>
                            Mystic
                        </strong>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_MD_max" type="number" value="6" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_MD" type="number" value="6" style="width: 45px;"/>
                    </td>
                    <td style="text-align: center;" />
                        <input name="attr_MA_max" type="number" value="2" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_MA" type="number" value="2" style="width: 45px;"/>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: center; text-align: right;">
                        <strong>
                            Social
                        </strong>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_SD_max" type="number" value="6" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center;">
                        <input name="attr_SD" type="number" value="6" style="width: 45px;"/>
                    </td>
                    <td style="text-align: center; vertical-align: top;" colspan="2">
                         
                    </td>
                </tr>
                <tr style="background-color: #f3e5d8;">
                    <td>
                        <strong>
                            Race
                        </strong>
                    </td>
                    <td colspan="2">
                        <input name="attr_Race" type="text" style="width:100px;"/>
                    </td>
                    <td>
                        <strong>
                            Karma Step
                        </strong>
                    </td>
                    <td style="width: 50px; vertical-align: center;">
                        <input name="attr_KarmaStep" type="number" value="4" style="width: 41px;"/>
                    </td>
                </tr>
                <tr>
                    <td style="width: 73px;">
                        <strong>
                            Discipline 1
                        </strong>
                    </td>
                    <td colspan="2">
                        <input name="attr_Discipline1" type="text" style="width:100px"/>
                    </td>
                    <td>
                        <strong>
                            Circle
                        </strong>
                    </td>
                    <td>
                        <input name="attr_Dis1Circle" type="number" value="1" style="width: 41px;"/>
                    </td>
                </tr>
                <tr style="background-color: #f3e5d8;">
                    <td>
                        <strong>
                            Discipline 2
                        </strong>
                    </td>
                    <td colspan="2">
                        <input name="attr_Discipline2" type="text" style="width:100px"/>
                    </td>
                    <td>
                        <strong>
                            Circle
                        </strong>
                    </td>
                    <td>
                        <input name="attr_Dis2Circle" type="number" value="0" style="width: 41px;"/>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: middle;">
                        <strong>
                            Recovery
                        </strong>
                    </td>
                    <td style="text-align: center; vertical-align: bottom;">
                        <strong>
                            Per Day
                        </strong>
                        <input name="attr_Recovery_max" type="number" value="1" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center; vertical-align: bottom;">
                        <strong>
                            Current
                        </strong>
                        <input name="attr_Recovery" type="number" value="1" style="width: 41px;"/>
                    </td>
                    <td style="text-align: center; vertical-align: bottom;">
                        <strong>
                            Karma?
                        </strong>
                        <select class="RecoveryKarma" name="attr_RecoveryKarma" style= "width: 55px; height: 23px">
                            <option value="No">
                                No
                            </option>
                            <option value="Yes">
                                Yes
                            </option>
                        </select>
                    </td>
                    <td style="text-align: center; vertical-align: middle;">
                        <span style="background-color: #ff0000;">
                            <button name="roll_Recovery" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} Recovery**
--Step|[[ ?{Step|@{TouStep}+@{TouMod}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
--Recovery|-1
}}">
                            </button>
                        </span>
                    </td>
                </tr>
            </tbody>
        </table>
    </td>
</tr>
</tbody>
</table>
<p></p>
<h3>Actions <input name="attr_Actions" style="width: 41px;" type="number" value="1"/> </h3>
<fieldset class="repeating_meleeweapons">
<table style="width: 725px; height: 70px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; background-color: #FFFFFF;" border="5">
                <tbody>
                    <tr style="background-color: #bfbfbf">
                        <td style="text-align: left; vertical-align: bottom; width: 160px" >
                            <strong>
                                NAME
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 45px">
                            <strong>
                                STEP
                            </strong>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                Vs DEFENSE
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 135px">
                            <strong>
                                ATTACK
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 45px; color: #eaeaea; background-color: #dd0000">
                            <strong>
                                STEP
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px; color: #eaeaea; background-color: #dd0000">
                            <strong>
                                Vs ARMOR
                            </strong>
                        </td>                        
                        <td style="vertical-align: bottom; text-align: center; width: 130px; color: #eaeaea; background-color: #dd0000">
                            <strong>
                                DAMAGE
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_WeaponName" type="text" style= "width: 150px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_AtkStep" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="WeaponDefense" name="attr_WeaponDefense" style= "width: 72px">
                                <option value="@{target|PD}">
                                    Physical
                                </option>
                                <option value="@{target|MD}">
                                    Mystic
                                </option>
                                <option value="@{target|SD}">
                                    Social
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            Public/GM Only/Target <br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_AtkStep" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{WeaponName}**
--leftsub|Attack
--Step|[[ ?{Step|@{AtkStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #f4c542;">
                                <button name="roll_AtkStepGM" type="roll" value="!power {{
--whisper|GM
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{WeaponName}**
--leftsub|Attack
--Step|[[ ?{Step|@{AtkStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #004fce;">
                                <button name="roll_AtkTarget" type="roll" value="!power {{
--format|grey
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{WeaponName}**
--leftsub|Attack vs @{target|token_name}
--Step|[[ ?{Step|@{AtkStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Successes|[[ {0d1, floor(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{WeaponDefense}) /5 +1) }kh1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_DamStep" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="WeaponDamType" name="attr_WeaponDamType" style= "width: 72px">
                                <option value="@{target|PA}">
                                    Physical
                                </option>
                                <option value="@{target|MA}">
                                    Mystic
                                </option>
                            </select>
                        </td>                        
                        <td style="vertical-align: top; text-align: center;">
                            Public/GM Only/Target <br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_DamStep" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{WeaponName}**
--leftsub|Damage
--Step|[[ ?{Step|@{DamStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #f4c542;">
                                <button name="roll_DamStepGM" type="roll" value="!power {{
--whisper|GM
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{WeaponName}**
--leftsub|Damage
--Step|[[ ?{Step|@{DamStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #004fce;">
                                <button name="roll_DamTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{WeaponName}**
--leftsub|Damage vs @{target|token_name}
--Step|[[ ?{Step|@{DamStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|0} ]] Strain
--Damage after Armor|[[ {0d1, ceil(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{WeaponDamType}) ) }kh1 ]]
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;" rowspan="1">
                            <strong>
                                SPECIAL
                            </strong>
                        </td>
                        <td style="text-align: left; vertical-align: top" colspan="6" rowspan="1">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_MWeaponSpecial"></textarea>
                        </td>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
<p></p>
<h3>Powers</h3>
<fieldset class="repeating_powers">
<table style="width: 725px; height: 100px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="1">
                <tbody>
                    <tr style="background-color: #ffa31a;">
                        <td style="text-align: left; vertical-align: bottom; width: 140px;">
                            <strong>
                                POWER
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STEP
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                RANK
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 70px">
                            <strong>
                                ACTION
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 40px">
                            <strong>
                                STRAIN
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 70px">
                            <strong>
                                Vs DEFENSE
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 200px">
                            <strong>
                                ROLL
                            </strong>
                        </td>
                        <td style="vertical-align: bottom; text-align: center; width: 175px">
                            <strong>
                                DURATION
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;">
                            <input name="attr_PowerName" type="text" style= "width: 140px"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_PowerStep" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_PowerRank" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="PowerAction" name="attr_PowerAction" style= "width: 81px">
                                <option value="Free">
                                    Free
                                </option>
                                <option value="Simple">
                                    Simple
                                </option>
                                <option value="Standard">
                                    Standard
                                </option>
                                <option value="Sustained">
                                    Sustained
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <input name="attr_PowerStrain" type="number" value="0" style="width: 41px;"/>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            <select class="PowerDefense" name="attr_PowerDefense" style= "width: 72px">
                                <option value="None">
                                    None
                                </option>
                                <option value="@{target|PD}">
                                    Physical
                                </option>
                                <option value="@{target|MD}">
                                    Mystic
                                </option>
                                <option value="@{target|SD}">
                                    Social
                                </option>
                            </select>
                        </td>
                        <td style="vertical-align: top; text-align: center;">
                            Public/GM Only/Target <br/>
                            <span style="background-color: #ff0000;">
                                <button name="roll_PowerStep" type="roll" value="!power {{
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{PowerName}**
--Step|[[ ?{Step|@{PowerStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{PowerStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{PowerDurationTotal} > 0 ?? Duration| @{PowerDurationTotal} @{PowerDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #f4c542;">
                                <button name="roll_PowerStepGM" type="roll" value="!power {{
--whisper|GM
--format|gold
--titlefont|arial
--titlefontsize|16px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{PowerName}**
--Step|[[ ?{Step|@{PowerStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{PowerStrain}} ]] Strain
--Result|**[[ [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] ]]**
--?? @{PowerDurationTotal} > 0 ?? Duration| @{PowerDurationTotal} @{PowerDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                            &nbsp;
                            <strong>/</strong>
                            &nbsp;
                            <span style="background-color: #004fce;">
                                <button name="roll_PowerTarget" type="roll" value="!power {{
--format|red
--titlefont|arial
--titlefontsize|14px
--bodyfontsize|12px
--charid|@{character_id}
--name|**@{Name} @{PowerName}**
--leftsub|vs @{target|token_name}
--Step|[[ ?{Step|@{PowerStep}-@{Wounds}} ]] + [[ ?{Karma #|0} ]] Karma, [[ ?{Strain #|@{PowerStrain}} ]] Strain
--Successes|[[ {0d1, floor(( { [[{1e3, 8}<[[{?{Step} - 11, 0}kh1 % 11]] + floor([[{?{Step} - 11, 0}kh1]] / 11)]]d20! + [[{2, 4, 5, 6, 7}=[[{?{Step}, 0}kh1 % 11]] + {1, 3}=[[{?{Step}, 0}kh1]] + {1e3, 3}=[[{?{Step} - 11, 0}kh1 % 11]] * 2]]d[[{{(?{Step} - 1) * 2, 4}kh1, {12} }kl1]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * (1 - {3, 6, 10}=[[{?{Step}, 0}kh1 % 11]] + {1, 4, 8}=[[{?{Step}, 0}kh1 % 11]])]]d[[10 - {4, 5, 8, 9}=[[{?{Step}, 0}kh1 % 11]] * 4]]! + [[{1e3, 8}<[[{?{Step}, 0}kh1]] * ({0, 5, 7, 9}=[[{?{Step}, 1}kh1 % 11]] + 2 * {6, 10}=[[{?{Step}, 0}kh1 % 11]])]]d8! - [[{1, 2}=[[{?{Step}, 0}kh1]] * (3 - [[{?{Step}, 0}kh1]])]] + [?{Karma #|0} Karma] [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep} - 11, 0}kh1 % 11]] + floor([[{@{KarmaStep} - 11, 0}kh1]] / 11))]]d20! + [[?{Karma #} * ({2, 4, 5, 6, 7}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 3}=[[{@{KarmaStep}, 0}kh1]] + {1e3, 3}=[[{@{KarmaStep} - 11, 0}kh1 % 11]] * 2)]]d[[{{(@{KarmaStep} - 1) * 2, 4}kh1, {12} }kl1]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * (1 - {3, 6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]] + {1, 4, 8}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d[[10 - {4, 5, 8, 9}=[[{@{KarmaStep}, 0}kh1 % 11]] * 4]]! + [[?{Karma #} * ({1e3, 8}<[[{@{KarmaStep}, 0}kh1]] * ({0, 5, 7, 9}=[[{@{KarmaStep}, 1}kh1 % 11]] + 2 * {6, 10}=[[{@{KarmaStep}, 0}kh1 % 11]]))]]d8! - [[?{Karma #} * ({1, 2}=[[{@{KarmaStep}, 0}kh1]] * (3 - [[{@{KarmaStep}, 0}kh1]]))]] } - @{PowerDefense}) /5 +1) }kh1 ]]
--?? @{PowerDurationTotal} > 0 ?? Duration| @{PowerDurationTotal} @{PowerDurationIncrement}
}}
!modattr {{
--silent
--charid @{character_id}
--Karma|-?{Karma #}
--Uncon|?{Strain #}
}}">
                                </button>
                            </span>
                        </td>
                        <td style="vertical-align: top; text-align: center;" rowspan="2">
                                <input name="attr_PowerDurationNumber" type="number" style="vertical-align: top; width: 41px;" value="0">
                                <strong>+</strong>
                                <select class="PowerDurationRank" name="attr_PowerDurationRank" style= "width: 53px">
                                    <option value="0">
                                        Zero
                                    </option>
                                    <option value="@{PowerRank}">
                                        Rank
                                    </option>
                                </select>
                                <strong>=</strong><br/>
                                <input disabled="disabled" name="attr_PowerDurationTotal" type="number" style="vertical-align: top; width: 41px;" value="@{PowerDurationNumber}+@{PowerDurationRank}">
                                <select class="PowerDurationIncrement" name="attr_PowerDurationIncrement" style= "width: 70px">
                                    <option value="Rounds">
                                        Rounds
                                    </option>
                                    <option value="Minutes">
                                        Minutes
                                    </option>
                                    <option value="Hours">
                                        Hours
                                    </option>
                                    <option value="Days">
                                        Days
                                    </option>
                                </select>
                            </td>
                    </tr>
                    <tr>
                        <td style="text-align: left; vertical-align: top;" rowspan="1">
                            <strong>
                                DESCRIPTION
                            </strong>
                        </td>
                        <td style="text-align: left; vertical-align: top;" colspan="6" rowspan="1">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_PowerDesc"></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
<p></p>
<h3>Special Maneuvers</h3>
<fieldset class="repeating_SpecialManeuvers">
<table style="width: 725px; height: 50px;" border="1">
<tbody>
    <tr>
        <td>
            <table style="width: 100%; height: 100%; background-color: #FFFFFF;" border="5" cellspacing="1" cellpadding="2">
                <tbody>
                    <tr>
                        <td style="text-align: left; vertical-align: top; width: 50px">
                            <strong>
                                NAME
                            </strong>
                        </td>
                        <td style="vertical-align: top;">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_SpecialName"></textarea>
                        </td>
                        <td style="text-align: left; vertical-align: top; width: 60px">
                            <strong>
                                TRIGGER
                            </strong>
                        </td>
                        <td style="vertical-align: top;">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_SpecialTrigger"></textarea>
                        </td>
                        <td style="text-align: left; vertical-align: top; width: 60px">
                            <strong>
                                EFFECT
                            </strong>
                        </td>
                        <td style="vertical-align: top;">
                            <textarea class="text-input-noback" style="width:90%; height:20px" name="attr_SpecialEffect"></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tbody>
</table>
</fieldset>
</div>
</div>
